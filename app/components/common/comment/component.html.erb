<article class="comment">
  <div class="flex gap-3 items-center">
    <div class="flex items-center gap-2">
      <span class="avatar"></span>
      <p class="text-sm"><%= record.user.email %></p>
    </div>
    <span class="dot-divider mt-1"></span>
    <p class="text-sm"><%= time_ago_in_words(record.created_at) %> ago</p>
    <div class="flex gap-4 items-center ml-auto">
      <%= turbo_frame_tag(dom_id(record, :controls)) do %>
        <% if author %>
          <%= render(partial: 'partials/comment_controls', locals: { record: }) %>
        <% else %>
          <% if author_of_post? %>
            <span class="badge">
              Author of post
            </span>
          <% end %>
        <% end %>
      <% end %>
    </div>
  </div>
  <%= turbo_stream_from(dom_id(record, :content)) %>
  <%= render(partial: 'partials/comment_content', locals: { record: }) %>
  <div class="relative flex items-center gap-2">
    <%= turbo_stream_from(dom_id(record, :like_count), class: "absolute") %>
    <%= turbo_frame_tag(dom_id(record, :likes)) do %>
      <% if author || !user %>
        <%= render(partial: 'partials/like', locals: { target: record }) %>
      <% else %>
        <%= render(partial: 'partials/like_form', locals: { user: user, target: record, 
        path: record.instance_of?(Comment) ? toggle_like_comment_path(record) : toggle_like_comment_reply_path(record.comment, record) }) %>
      <% end %>
    <% end %>
  </div>
  <% if replies %>
    <%= render(Replies::Component.new(comment: record, replies: replies, user:)) %>
  <% end %>
</article>